


 ## Event 

### 上报航线任务进度
**Topic:** thing/product/{pid}/events

**Direction:** up

**Method:** flighttask_progress

**Data:** 
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|ext|扩展内容|struct||| 
|»current_waypoint_index|当前执行到的航点数|int|{}|| 
|»media_count|本次航线任务执行产生的媒体文件数量|int|{}|| 
|»track_id|航迹id|text|{}|| 
|progress|进度|struct||| 
|»current_step|执行步骤|enum|{&#34;1&#34;:&#34;下载kmz航线任务&#34;,&#34;2&#34;:&#34;KMZ上传中&#34;,&#34;3&#34;:&#34;航线执行&#34;}|| 
|»percent|进度值|int|{&#34;min&#34;:&#34;0&#34;,&#34;max&#34;:&#34;100&#34;,&#34;step&#34;:&#34;1&#34;}|| 

 
 
**Example:** 
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"ext": {
				"current_waypoint_index": 3,
				"media_count": 6,
				"track_id": "track_id"
			},
			"progress": {
				"current_step": 19,
				"percent": 100
			},
			"status": "ok"
		},
		"result": 0
	},
	"method": "flighttask_progress",
	"timestamp": 1654070968655
}
```



 



 ## Service 

### 创建航线任务
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** flighttask_create

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|flight_id|计划ID|text|{}||
|type|任务类型|text|{}||
|file|航线文件对象|struct||| 
|»url|文件url|text|{}|| 
|»sign|Md5签名|text|{}|| 

 
 
**Example:** 
```json
{
	"method": "flighttask_create",
	"timestamp:": 1654070968655,
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_id": "xxxxxxx",
		"type": "wayline",
		"file": {
			"url": "https://xxx.com/xxxx",
			"sign": "xxxx"
		}
	}
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** flighttask_create

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|返回码|int||非0代表错误|

 
 
**Example:** 
```json
{
	"method": "flighttask_create",
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"data": {
		"result": 0
	}
}
```




