




 # Event

## Notification of device exits the Return to Home (RTH) state
**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** device_exit_homing_notify

**Data:** 
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|action|Notification type of exiting RTH|enum_int|{&#34;0&#34;:&#34;Exit `exiting RTH state`&#34;,&#34;1&#34;:&#34;Enter `exiting RTH state`&#34;}|Entering the `RTH exiting state` means that the aircraft exits the RTH process due to one of the reasons in the reason field of Cloud API. Exiting the `RTH exiting state` means the aircraft stop the exiting process.|
|reason|Reason for exiting RTH|enum_int|{&#34;0&#34;:&#34;Add joystick throttle&#34;,&#34;1&#34;:&#34;Add joystick pitch&#34;,&#34;2&#34;:&#34;The initialization of behavior tree is failed&#34;,&#34;3&#34;:&#34;Surrounded by obstacles&#34;,&#34;4&#34;:&#34;Flight restriction is triggered&#34;,&#34;5&#34;:&#34;Obstacle is too closed&#34;,&#34;6&#34;:&#34;No GPS signal&#34;,&#34;7&#34;:&#34;The output flag of GPS and VIO location is false&#34;,&#34;8&#34;:&#34;The error of GPS and VIO fusion position is too large&#34;,&#34;9&#34;:&#34;Backtrack in a short distance&#34;,&#34;10&#34;:&#34;Trigger the RTH in a short distance&#34;}||

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"action": 1,
		"reason": "0",
		"sn": "Dock SN"
	},
	"need_reply": true,
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
        "method": "device_exit_homing_notify"
}
```




## Report wayline task progress
**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** flighttask_progress

**Data:** 
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|ext|Expand content|struct||| 
|»current_waypoint_index|Current waypoint index|int||| 
|»wayline_mission_state|Wayline mission state|enum_int|{&#34;0&#34;:&#34;Disconnect&#34;,&#34;1&#34;:&#34;Do not support this waypoint&#34;,&#34;2&#34;:&#34;Wayline is ready. File can be uploaded and uploaded file can be executed.&#34;,&#34;3&#34;:&#34;Wayline file is uploading&#34;,&#34;4&#34;:&#34;Trigger start command. Trgger aircraft reading wayline. Not start. Under preparation.&#34;,&#34;5&#34;:&#34;Enter wayline and arrive first waypoint&#34;,&#34;6&#34;:&#34;Execute wayline&#34;,&#34;7&#34;:&#34;Wayline is broken. Trigger reason: 1. User pauses the wayline. 2. Flight control is abnormal.&#34;,&#34;8&#34;:&#34;Wayline recover&#34;,&#34;9&#34;:&#34;Wayline stop&#34;}|| 
|»media_count|Media file number generated by the wayline mission execution|int||| 
|»track_id|Wayline ID|text||| 
|»flight_id|Mission ID|text||| 
|»break_point|Wayline breakpoint information|struct||Optional field for resuming interrupted wayline task. If specified, the wayline task will start executing from the breakpoint position indicated by the field.|
|»»index|Breakpoint index|int|||
|»»state|Breakpoint state|enum_int|{&#34;0&#34;:&#34;On the wayline segment&#34;,&#34;1&#34;:&#34;On the waypoint&#34;}||
|»»progress|Current wayline segment progress|float|{&#34;max&#34;:&#34;1.0&#34;,&#34;min&#34;:&#34;0&#34;}||
|»»wayline_id|Wayline ID|int|||
|»»break_reason|Break reason|enum_int|{}||
|»»latitude|Breakpoint latitude|float|{&#34;max&#34;:&#34;90&#34;,&#34;min&#34;:&#34;-90&#34;,&#34;unit&#34;:&#34;degree / °&#34;}||
|»»longitude|Breakpoint longitude|float|{&#34;max&#34;:&#34;180&#34;,&#34;min&#34;:&#34;-180&#34;,&#34;unit&#34;:&#34;degree / °&#34;}||
|»»height|Breakpoint altitude relative to the Earth&#39;s ellipsoid surface|float|{&#34;unit&#34;:&#34;meter / m&#34;}||
|»»attitude_head|Breakpoint yaw angle|float||Yaw angle relative to true north (meridian), with positive values from 0 to 6 o&#39;clock direction and negative values from 6 to 12 o&#39;clock direction|
|»wayline_id|Currently working wayline ID|int||This includes the transitional phase of entering the flight path. For example, 0 indicates that the spacecraft is entering or already executing the first route.| 
|status|Task state|enum_string|{&#34;partially_done&#34;:&#34;partially done&#34;,&#34;sent&#34;:&#34;sent&#34;,&#34;in_progress&#34;:&#34;in progress&#34;,&#34;ok&#34;:&#34;success&#34;,&#34;paused&#34;:&#34;paused&#34;,&#34;rejected&#34;:&#34;rejected&#34;,&#34;failed&#34;:&#34;failed&#34;,&#34;canceled&#34;:&#34;canceled or stopped&#34;,&#34;timeout&#34;:&#34;timeout&#34;}||
|progress|Progress|struct||| 
|»current_step|Execute Step|enum_int|{&#34;0&#34;:&#34;Initial state&#34;,&#34;1&#34;:&#34;Pre-launch check: Is the spacecraft executing the route?&#34;,&#34;2&#34;:&#34;Pre-launch check: Is the airport exiting work mode?&#34;,&#34;3&#34;:&#34;Pre-launch check: Route execution in progress&#34;,&#34;4&#34;:&#34;Pre-launch check: Return in progress&#34;,&#34;5&#34;:&#34;Route execution entering preparation state, waiting for task issuance to begin&#34;,&#34;6&#34;:&#34;Airport entering operational state&#34;,&#34;7&#34;:&#34;Entering startup check preparation and hatch opening preparation&#34;,&#34;8&#34;:&#34;Waiting for flight system readiness, push connection establishment&#34;,&#34;9&#34;:&#34;Waiting for RTK source monitoring with reported values&#34;,&#34;10&#34;:&#34;Check if RTK source is from the airport; if not, reset&#34;,&#34;11&#34;:&#34;Waiting for flight control notification&#34;,&#34;12&#34;:&#34;Airport has no control; wresting control from the aircraft&#34;,&#34;13&#34;:&#34;Get the latest KMZ URL&#34;,&#34;14&#34;:&#34;Download KMZ&#34;,&#34;15&#34;:&#34;KMZ uploading&#34;,&#34;16&#34;:&#34;Dye configuration&#34;,&#34;17&#34;:&#34;Aircraft takeoff parameter settings, alternate landing point settings, takeoff altitude settings, dye settings&#34;,&#34;18&#34;:&#34;Aircraft &#39;flyto&#39; takeoff parameter settings&#34;,&#34;19&#34;:&#34;Home point settings&#34;,&#34;20&#34;:&#34;Trigger route execution&#34;,&#34;21&#34;:&#34;Route execution in progress&#34;,&#34;22&#34;:&#34;Entering return check preparation&#34;,&#34;23&#34;:&#34;Aircraft landing at the airport&#34;,&#34;24&#34;:&#34;Hatch closure after landing&#34;,&#34;25&#34;:&#34;Airport exiting work mode&#34;,&#34;26&#34;:&#34;Airport abnormal recovery&#34;,&#34;27&#34;:&#34;Airport uploading flight system logs&#34;,&#34;28&#34;:&#34;Camera recording status check&#34;,&#34;29&#34;:&#34;Get the number of media files&#34;,&#34;30&#34;:&#34;Abnormal recovery of airport takeoff hatch opening&#34;,&#34;31&#34;:&#34;Notify task results&#34;,&#34;32&#34;:&#34;Task execution completed; whether to initiate log retrieval based on configuration file&#34;,&#34;33&#34;:&#34;Log list retrieval - Aircraft list&#34;,&#34;34&#34;:&#34;Log list retrieval - Airport list retrieval&#34;,&#34;35&#34;:&#34;Log list retrieval - Upload log list results&#34;,&#34;36&#34;:&#34;Log retrieval - Retrieve aircraft logs&#34;,&#34;37&#34;:&#34;Log retrieval - Retrieve airport logs&#34;,&#34;38&#34;:&#34;Log retrieval - Compress aircraft logs&#34;,&#34;39&#34;:&#34;Log retrieval - Compress airport logs&#34;,&#34;40&#34;:&#34;Log retrieval - Upload aircraft logs&#34;,&#34;41&#34;:&#34;Log retrieval - Upload airport logs&#34;,&#34;42&#34;:&#34;Log retrieval - Notify results&#34;,&#34;0xFFFD&#34;:&#34;Waiting for service response after completion&#34;,&#34;0xFFFE&#34;:&#34;No specific status&#34;,&#34;0xFFFFF&#34;:&#34;UNKNOWN&#34;}|| 
|»percent|Progress value|int|{&#34;max&#34;:&#34;100&#34;,&#34;min&#34;:&#34;0&#34;,&#34;step&#34;:&#34;1&#34;}|| 

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"ext": {
				"break_point": {
					"attitude_head": 30,
					"break_reason": 1,
					"height": 100.23,
					"index": 1,
					"latitude": 23.4,
					"longitude": 113.99,
					"progress": 0.34,
					"state": 0,
					"wayline_id": 0
				},
				"current_waypoint_index": 3,
				"wayline_mission_state": 9,
				"wayline_id": 0,
				"flight_id": "flight_id",
				"media_count": 6,
				"track_id": "track_id"
			},
			"progress": {
				"current_step": 19,
				"percent": 100
			},
			"status": "ok"
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_progress"
}
```




## Notification of task readiness
**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** flighttask_ready

**Data:** 
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
  |flight_ids|Mission ID|array|{"size": }|The task ID set that currently satisfies the task readiness conditions|
|»[array_item]|Elements in array|text||| 

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_ids": [
			"aaaaaaa",
			"bbbbbbb"
		]
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_ready"
}
```




## Return-to-home information
**Topic:** thing/product/*{gateway_sn}*/events

**Direction:** up

**Method:** return_home_info

**Data:** 
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
  |planned_path_points|Planned trajectory point list|array|{}|The real-time planned return route for the aircraft. Each push is a complete update of the route. There is an complete return path in the array.|
|»[array_item]|Elements in array|struct|{}|{"size": ""}|
|»»latitude|Trajectory point latitude(angle)|double|{&#34;min&#34;:-90,&#34;max&#34;:90}|The latitude of trajectory points, given in angular values. Negative values for south latitude and positive values for north latitude. Value is accurate to six decimal places.|
|»»longitude|Trajectory point longitude(angle)|double|{&#34;min&#34;:-180,&#34;max&#34;:180}|The latitude of trajectory points, given in angular values. Negative values for wast latitude and positive values for east latitude. Value is accurate to six decimal places.|
|»»height|Trajectory point height|float|{&#34;unit&#34;:&#34;meter / m&#34;,&#34;step&#34;:0.1}|ellipsoidal height|
|last_point_type|Type of the last point of trajectory|enum_int|{&#34;0&#34;:&#34;Last point of trajectory is located above the return point.&#34;,&#34;1&#34;:&#34;Last point of trajectory is not located above the return point.&#34;}|You can use this field to determine the display mode of the last point in the trajectory. 0 means the last point of the trajectory is located above the return point on the ground. The terminal can display a line connecting the last point of the trajectory to the return point. 1 means the last point of the trajectory is not the return point. The terminal should not display a line connecting the last point of the trajectory to the return point. The reason for not being able to reach the return point could be that the return point is in a restricted zones or inside an obstacle.|
|flight_id|Mission ID|text||Currently working wayline mission ID|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_id": "abc",
		"planned_path_points": [
			{
				"latitude": 13.23,
				"longitude": 123.234,
				"height": 123.234
			}
		],
		"last_point_type": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "return_home_info"
}
```







 # Service

## Create wayline task (Deprecated)



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_create

**Data:**
 |Column|Name|Type|constraint|Description| 
|---|---|---|---|---|
|flight_id|Mission ID|text|||
|type|Mission type|text|||
|file|Wayline file object|struct||| 
|»url|File URL|text||| 
|»sign|MD5 signature|text||| 

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"file": {
			"sign": "xxxx",
			"url": "https://xxx.com/xxxx"
		},
		"flight_id": "xxxxxxx",
		"type": "wayline"
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "flighttask_create"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_create

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "flighttask_create"
}
```


## Issue mission

If user&#39;s cloud service can not connect to the Internet (that is, the WAN), it is necessary to implement the [update configuration](https://developer.dji.com/doc/cloud-api-tutorial/en/api-reference/dock-to-cloud/mqtt/dock/config.html) function to send the URL of the NTP service which can be accessed by the cloud service to synchronize the clock. Otherwise, the wayline task can not work properly.

**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_prepare

**Data:**
 |Column|Name|Type|constraint|Description| 
|---|---|---|---|---|
|flight_id|Mission ID|text|||
|execute_time|Execution start time|int|{&#34;length&#34;:13}|Millisecond timestamp of mission execution time. Optional field. When the `task_type` is 0 or 1, it is required. When the `task_type` is 2, it is not required.|
|task_type|Mission type|enum_int|{&#34;0&#34;:&#34;Immediate mission&#34;,&#34;1&#34;:&#34;Timed mission&#34;,&#34;2&#34;:&#34;Conditional mission&#34;}|The execution time of immediate task and timed task are defined by `execute_time`. The conditional mission supports the task readiness condition defined by `ready_conditions`. The task can be executed if conditions are satisfied within a specified period. Immediate task has the highest priority. Timed task and conditional mission have the same priority.|
|wayline_type|Wayline type|enum_int|{&#34;0&#34;:&#34;Normal waypoint wayline&#34;}||
|file|Wayline file object|struct||| 
|»url|File  URL|text||| 
|»fingerprint|File signature|text||File content MD5 signature| 
|ready_conditions|Notification of task readiness|struct||Optional field. Required for conditional missions (when `task_type` is 2), and will be ignored by other types of missions. After sending a conditional mission, the device will periodically check whether all the `ready_conditions` are met. If all conditions are met, it will trigger a `flighttask_ready` event notification. Additionally, when the device receives the `flighttask_execute` command, it will also check whether all the `ready_conditions` for the task have been met.| 
|»battery_capacity|Battery capacity|int||The aircraft battery percentage threshold of the executable task. The aircraft battery must be greater than the `battery_capacity` when the task starts.| 
|»begin_time|Start time of the mission executable period|int|{&#34;length&#34;:13}|Start millisecond timestamp of the mission executable period. The mission execution time should be later than the `begin_time`| 
|»end_time|End time of the mission executable period|int|{&#34;length&#34;:13}|End millisecond timestamp of the mission executable period. The mission execution time should be earlier than the `end_time`.| 
|executable_conditions|Mission executable condition|struct||Optional field. Pre-check conditions added for task execution on the device side. If any condition is not satisfied, execution will fail.| 
|»storage_capacity|Storage capacity|int||The minimum storage capacity of DJI dock or aircraft that can execute a task. Unit: MB. If the storage capacity doesn&#39;t satisfy the `storage_capacity`, task execution will fail.| 
|break_point|Wayline breakpoint information|struct||Optional field for resuming interrupted wayline task. If specified, the wayline task will start executing from the breakpoint position indicated by the field.| 
|»index|Breakpoint index|int||| 
|»state|Breakpoint state|enum_int|{&#34;0&#34;:&#34;On the wayline segment&#34;,&#34;1&#34;:&#34;On the waypoint&#34;}|| 
|»progress|Current wayline segment process|float|{&#34;max&#34;:&#34;1.0&#34;,&#34;min&#34;:&#34;0&#34;}|| 
|»wayline_id|Wayline ID|int||| 
|rth_altitude|Return-to-home altitude|int|{&#34;max&#34;:1500,&#34;min&#34;:20,&#34;unit&#34;:&#34;meter / m&#34;}||
|rth_mode|RTH height mode|enum_int|{&#34;0&#34;:&#34;Optimal height&#34;,&#34;1&#34;:&#34;Preset height&#34;}|Under optimal RTH mode, aircraft will automatically plan the optimal return altitude. Currently, the DJI dock does not support setting the return altitude mode. You can only choose the &#39;Preset height&#39; mode. When the environment and lighting do not meet the requirements of the visual system (such as direct sunlight in the evening or no light at night), the aircraft will perform a straight-line return at the altitude you have set.|
|out_of_control_action|Remote controller out of control action|enum_int|{&#34;0&#34;:&#34;Return-to-home (RTH)&#34;,&#34;1&#34;:&#34;Hovering&#34;,&#34;2&#34;:&#34;Landing&#34;}|Current default transmitted value is 0, meaning Return-to-home (RTH). Note that this enumeration value definition is inconsistent with the flight control and dock definitions, and a conversion exists at the dock end.|
|exit_wayline_when_rc_lost|Wayline out of control action|enum_int|{&#34;0&#34;:&#34;Continue executing the wayline task&#34;,&#34;1&#34;:&#34;Exit the wayline task and execute the remote controller out of control action&#34;}|consistent with the KMZ file|
|simulate_mission|Whether execute mission in simulator|struct||Optional field. Used to indoor debugging the simulated mission.| 
|»is_enable|Whether enable a simulated mission|enum_int|{&#34;0&#34;:&#34;Disable&#34;,&#34;1&#34;:&#34;Enable&#34;}|| 
|»latitude|Latitude|double|{&#34;max&#34;:&#34;90.0&#34;,&#34;min&#34;:&#34;-90.0&#34;}|| 
|»longitude|Longitude|double|{&#34;max&#34;:&#34;180.0&#34;,&#34;min&#34;:&#34;-180.0&#34;}|| 

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"break_point": {
			"index": 1,
			"progress": 0.34,
			"state": 0,
			"wayline_id": 0
		},
		"executable_conditions": {
			"storage_capacity": 1000
		},
		"execute_time": 1234567890123,
		"file": {
			"fingerprint": "xxxx",
			"url": "https://xxx.com/xxxx"
		},
		"flight_id": "xxxxxxx",
		"out_of_control_action": 0,
		"exit_wayline_when_rc_lost": 0,
		"ready_conditions": {
			"battery_capacity": 90,
			"begin_time": 1234567890123,
			"end_time": 1234567890123
		},
		"rth_altitude": 100,
		"task_type": 2,
		"wayline_type": 1,
		"simulate_mission": {
			"is_enable": 1,
			"latitude": 22.1223,
			"longitude": 113.2222
		}
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_prepare"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_prepare

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_prepare"
}
```


## Execute mission



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_execute

**Data:**
 |Column|Name|Type|constraint|Description| 
|---|---|---|---|---|
|flight_id|Mission ID|text|||

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_id": "xxxxxxx"
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_execute"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_execute

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_execute"
}
```


## Cancel mission



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_undo

**Data:**
 |Column|Name|Type|constraint|Description| 
|---|---|---|---|---|
  |flight_ids|Mission ID|array|{"size": }||
|»[array_item]|Elements in array|text||| 

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_ids": [
			"aaaaaaa",
			"bbbbbbb"
		]
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_undo"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_undo

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_undo"
}
```


## Pause mission



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_pause

**Data:** null 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_pause"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_pause

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"need_reply": true,
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_pause"
}
```


## Resume mission



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** flighttask_recovery

**Data:** null 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_recovery"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** flighttask_recovery

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"need_reply": true,
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "flighttask_recovery"
}
```


## One-key RTH



**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** return_home

**Data:** null 



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** return_home

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|
|output|Output|struct||| 
|»status|Mission state|enum_string|{&#34;sent&#34;:&#34;sent&#34;,&#34;in_progress&#34;:&#34;in progress&#34;,&#34;ok&#34;:&#34;succeeded&#34;,&#34;paused&#34;:&#34;paused&#34;,&#34;rejected&#34;:&#34;rejected&#34;,&#34;failed&#34;:&#34;failed&#34;,&#34;canceled&#34;:&#34;canceled or terminated&#34;,&#34;timeout&#34;:&#34;timeout&#34;}|| 

 


## Cancel RTH

After returning to home, the aircraft will exit the wayline mode. At this point, if the return-to-home command is canceled, the aircraft will hover.

**Topic:** thing/product/*{gateway_sn}*/services

**Direction:** down

**Method:** return_home_cancel

**Data:** null 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "return_home_cancel"
}
```



**Topic:** thing/product/*{gateway_sn}*/services_reply

**Direction:** up

**Method:** return_home_cancel

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"result": 0
	},
	"need_reply": true,
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1654070968655,
	"method": "return_home_cancel"
}
```



 # Requests

## 任务资源获取



**Topic:** thing/product/*{gateway_sn}*/requests

**Direction:** up

**Method:** flighttask_resource_get

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|flight_id|Mission ID|text|||

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"flight_id": "xxxxxxx"
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_resource_get"
}
```



**Topic:** thing/product/*{gateway_sn}*/requests_reply

**Direction:** down

**Method:** flighttask_resource_get

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|result|Return Code|int||Non-0 means error|
|output|输出|struct||| 
|»file|Wayline file object|struct|||
|»»url|File  URL|text|||
|»»fingerprint|File 签名|text||File  MD5 签名|

 

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"data": {
		"output": {
			"file": {
				"fingerprint": "signxxxx",
				"url": "https://xx.oss-cn-hangzhou.aliyuncs.com/xx.kmz?Expires=xx&OSSAccessKeyId=xxx&Signature=xxx"
			}
		},
		"result": 0
	},
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp": 1234567890123,
	"method": "flighttask_resource_get"
}
```



