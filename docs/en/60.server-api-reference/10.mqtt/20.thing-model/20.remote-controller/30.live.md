## Description of Variables
Before reading the protocol, you can get familiar with the variables. In the process of reading the protocol, you can return this page for reference.

| Variable Name              | Description                                                  | Remark                                      |
| -------------------------- | ------------------------------------------------------------ | ------------------------------------------- |
| `device_list`              | Indicate the list of aircraft (or other devices), which contains the camera. |                                             |
| `available_video_number`   | The total number of video streams available for live streaming. Indicates the total number of all available live video streams owned by the aircraft or devices. |                                             |
| `coexist_video_number_max` | The maximum total number of video streams that can be live streaming at the same time. |                                             |
| `camera_list`              | Indicates the list of cameras owned by aircraft, which contains the video. |                                             |
| `camera_type`              | Camera model                                                 |                                             |
| `camera_id`                | The id number of the camera is composed of the model name of the camera and the position number of the camera on the aircraft. This number is unique in an aircraft (or device). |                                             |
| `video_list`               | Indicates the list of video streams owned by camera.         |                                             |
| `video_type`               | Indicate the type of video stream. Such as H20T camera, there are several types of wide, zoom, ir and normal. Regarding the difference between normal and others: normal means that the video stream content of the channel will change. For example, when the APP adjusts the screen content at the front end, the H20T live screen content will change. Wide, zoom, and ir indicate that the channel is used to transmit the screen of the specified content. Unless the channel is switched, the screen content in the channel is fixed and will not be affected by APP adjustments. |                                             |
| `video_index`              | Indicates the index and number of the video stream, as shown by the type of the video stream and the number of the video stream inside the camera. Such as wide-0, in a camera domain, the number is unique. |                                             |
| `video_id`                 | It is used to uniquely specify the ID number of a video stream. The composition rule is `#{uav_sn}/#{camera_id}/#{video_index}` <br/>Example:`AFAFEFA34D/H20T-0/normal-1` |                                             |
| `video_quality`            | The quality of the live streaming, referring to several levels of live streaming parameters, such as Auto, Smooth, HD, Ultra HD. Each level has preset values for bps, fps, and resolution attributes. If you choose Auto, it will automatically adjust among the Smooth, HD, and ultra HD. |                                             |
| `video_param_mode`         | It is used to query or set the mode prompts which used in live streaming related information. Currently, there are only two types of default and advanced. Default means to set video_quality, and advanced means to set the bps, fps, and resolution (dpi) of the video in detail. |                                             |
| `live_trendline`           | Indicates the usage status of live streaming bandwidth (or the trend of live streaming performance). Each live channel has three states: normal, overuse, and underuse. For example, overuse means that the bandwidth usage is overloaded, thereby judging that the network is congested. If it is underuse, it means that the bandwidth has not been fully utilized. The value range is [0,10]: 0-4 means overuse, the smaller the value, the greater the degree of overuse. 5 means the normal state. 6~10 means underuse, the larger the value, the more percentage of bandwidth is not fully utilized. | Corresponds to the previous netlink_quality |
| `live_time`                | Live streaming time. Indicates the time that the device has been running since the start of the live streaming. |                                             |
| `url_type`                 | The url type that needs to be specified for the live streaming parameters. The type can be GB28181, RTMP, RTSP, Agora and other live protocols. |                                             |
| `url`                      | On the basis of determining the URL type, url is used to specify the specific url parameters based on the url_type. For different url_types, there are some differences in url composition rules. For the URL parameters of Agora, in order to prevent special characters from being included in the token, the cloud uses URLEncoder to encode and send it, and the pull stream side needs to be parsed by URLDecoder before use. |                                             |
| `fps`                      | The frame rate of the video stream.                          |                                             |
| `bps`                      | The bit rate of the video stream.                            |                                             |
| `dpi`                      | The resolution of the video stream.                          |                                             |


## Property

### Livestream ability update
**Topic:** thing/product/{pid}/state

**Direction:** up

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|live_capacity|Livestream ability|struct|||
|»available_video_number|Total number of video streams available for live broadcast|int|{}|Indicates the total number of all available live video streams owned by the aircraft or device|
|»coexist_video_number_max|Maximum total number of video streams that can be broadcast simultaneously|int|{}||
|»device_list|Device live broadcast capability list|array|{}||
|»»[array_item]|Elements in array|struct|{}|{"size": "2"}|
**Example:**
```json
{
  "bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "data": {
    "live_capacity": {
      "available_video_number": 2,
      "coexist_video_number_max": 1,
      "device_list": [
        {
          "available_video_number": 2,
          "camera_list": [
            {
              "available_video_number": 1,
              "camera_index": "42-0-0",
              "coexist_video_number_max": 1,
              "video_list": [
                {
                  "video_index": "zoom-0",
                  "video_type": "zoom"
                },
                {
                  "video_index": "wide-0",
                  "video_type": "wide"
                }
              ]
            },
            {
              "available_video_number": 1,
              "camera_index": "39-0-7",
              "coexist_video_number_max": 1,
              "video_list": [
                {
                  "video_index": "normal-0",
                  "video_type": "normal"
                }
              ]
            }
          ],
          "coexist_video_number_max": 0,
          "sn": "1ZNDH1D0010054"
        }
      ]
    }
  },
  "timestamp:": 1654070968655,
  "gateway": "1ZMDGBW0000135"
}
```







## Service

### Set the detailed configuration information of one live video stream
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** live_set_detail

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|video_id|Livestream stream identifier|text||The format is #{uav_sn}/#{camera_id}/#{video_index}, drone serial number/payload and mounted location enumeration value/payload lens numbering|
|fps|Livestream video frame rate|int|||
|bps|Livestream video bit rate|int|||
|dpi|Livestream video resolution|text|||



**Example:**
```json
{
  "method": "live_set_detail",
  "bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "data": {
    "video_id": "AFAFEFA34D/0-43-0/normal-1",
    "fps": 30,
    "bps": 3000000,
    "dpi": "1920x1080"
  }
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** live_set_detail

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|fps|Livestream video frame rate|int|||
|bps|Livestream video bit rate|int|||
|dpi|Livestream video resolution|text|||



**Example:**
```json
{
  "method": "live_set_detail",
  "bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
  "data": {
    "result": 0,
    "output": {
      "fps": 30,
      "bps": 3000000,
      "dpi": "1920x1080"
    }
  }
}
```


### Start livestreaming
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** live_start_push

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|url_type|Livestream protocol type|enum|{&#34;0&#34;:&#34;Agora&#34;,&#34;1&#34;:&#34;RTMP&#34;,&#34;2&#34;:&#34;RTSP&#34;,&#34;3&#34;:&#34;GB28181&#34;}||
|url|Livestream parameter|text|{}|RTMP: (rtmp://xxxxxxx) Example: rtmp://192.168.1.1:8080/live	RTSP：(uerName&#38;password&#38;port)	 Example: userName=dji-cloud-api&#38;password=123456&#38;port=8080	GB28181：(serverIP&#38;serverPort&#38;serverID&#38;agentID&#38;agentPassword&#38;localPort&#38;channel)	 Example:  serverIP=192.168.1.1&#38;serverPort=8080&#38;serverID=34000000000000000000&#38;agentID=300000000010000000000&#38;agentPassword=0000000&#38;localPort=7060&#38;channel=340000000000000000000	声网AGORA：(channel&#38;sn&#38;token&#38;uid)	 Example:  channel=1ZNDH360010162_39-0-7&#38;sn=1ZNDH360010162&#38;token=006dca67721582a48768ec4d817b7b25a86IAB4cw2JgN6iX8BpTPdc3e4S1Iendz94IFJ56aSXKvzAJei27MqF2zyCIgCLIIoBt41+YAQAAQC3jX5gAgC3jX5gAwC3jX5gBAC3jX5g&#38;uid=50000	 Notice: The token generated by Shengwang may have special characters such as &#39;+&#39; &#39; &#39;, and need to do url encode, otherwise there will be a parsing error on the PILOT side|
|video_id|Livestream video stream ID numbering|text|{}|The format is #{uav_sn}/#{camera_id}/#{video_index}, drone serial number/payload and mounted location enumeration value/payload lens numbering|
|video_quality|Livestream quality|enum|{&#34;0&#34;:&#34;Adaptive&#34;,&#34;1&#34;:&#34;Fluid&#34;,&#34;2&#34;:&#34;SD&#34;,&#34;3&#34;:&#34;HD&#34;,&#34;4&#34;:&#34;Super clear&#34;}||



**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_start_push",
	"data": {
		"url_type": 0,
		"url": "channel=1ZNDH1D0010098_39-0-7&sn=1ZNDH1D0010098&token=006dca67721582a48768ec4d817b7b25a86IADk%2Fcm%2Fdv%2BHY6qT%2FAKM6y7TcUe4lXNvZpycH7vUMAlM6pFALUKF2zyCIgA82pQE8cCoYAQAAQDxwKhgAgDxwKhgAwDxwKhgBADxwKhg&uid=50000",
		"video_id": "1ZNDH1D0010098/39-0-7/normal-0",
		"video_quality": 0
	}
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** live_start_push

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|info|Livestream information|text|{}|If you need to bring parameters when answering, you can add it in info. For example, RTSP needs to return the live url address of the device.|



**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_start_push",
	"data": {
		"result": 0,
		"info": "rtsp://${username}:${password}@192.168.1.100:8445/live/1"
	}
}
```


### Stop livestreaming
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** live_stop_push

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|video_id|Livestream video stream ID numbering|text|{}|The format is #{uav_sn}/#{camera_id}/#{video_index}, drone serial number/payload and mounted location enumeration value/payload lens numbering|



**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_stop_push",
	"data": {
		"video_id": "1ZNDH1D0010098/42-0-0/zoom-0"
	}
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** live_stop_push

**Data:** null

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_stop_push",
	"data": {
		"result": 0
	}
}
```


### Set livestream quality
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** live_set_quality

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|video_id|Livestream video stream |text|{}|The format is #{uav_sn}/#{camera_id}/#{video_index}, drone serial number/payload and mounted location enumeration value/payload lens numbering|
|video_quality|Livestream quality|enum|{&#34;0&#34;:&#34;Adaptive&#34;,&#34;1&#34;:&#34;Fluid&#34;,&#34;2&#34;:&#34;SD&#34;,&#34;3&#34;:&#34;HD&#34;,&#34;4&#34;:&#34;Super clear&#34;}||



**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_set_quality",
	"data": {
		"video_id": "1ZNDH1D0010098/39-0-7/normal-0",
		"video_quality": 4
	}
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** live_set_quality

**Data:** null

**Example:**
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_set_quality",
	"data": {
		"result": 0
	}
}
```


### Set livestream lens
**Topic:** thing/product/{pid}/services

**Direction:** down

**Method:** live_lens_change

**Data:**
|Column|Name|Type|constraint|Description|
|---|---|---|---|---|
|video_id|Livestream video stream |text|{}|The format is #{uav_sn}/#{camera_id}/#{video_index}, drone serial number/payload and mounted location enumeration value/payload lens numbering|
 |video_type|Livestream lens type|enum|{&#34;normal&#34;:&#34;default&#34;,&#34;wide&#34;:&#34;wide&#34;,&#34;zoom&#34;:&#34;zoom&#34;,&#34;ir&#34;:&#34;ir&#34;}||

 
 
**Example:** 
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_lens_change",
	"data": {
		"video_id": "1581F5BMD228Q00A82XX/39-0-7/zoom-0",
		"video_type": "zoom"
	}
}
```



**Topic:** thing/product/{pid}/services_reply

**Direction:** up

**Method:** live_lens_change

**Data:** null 
 
**Example:** 
```json
{
	"bid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"tid": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxx",
	"timestamp:": 1654070968655,
	"method": "live_lens_change",
	"data": {
		"result": 0
	}
}
```




